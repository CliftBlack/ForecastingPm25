
#library#
library(nnfor)
library(tseries)
library(forecast)
library("lmtest")

#SARIMA#
data=c(832,1065,1017,630,938,824,643,1039,1462,1425,1341,698,1045,1269,1537,1563,
       1901,2220,2030,2111,1827,1697,1631,1192,2397,2251,2280,1969,2332,2338,2113,2505,
       2435,2601,2354,1499,3361,3034,2920,1873,1478,1734,1803,2782,2935,3361,3085,2280,
       4673,4485,4775,3429,3898,3579,2236,3684,3225,2871,3573,2900,5318,6631,9180,5908,
       6893,7511,5836,7912,8810,7103,7302,5980,11533,14475,16141,10762,14534,16099,
       11937)
data_ts<-ts(data,frequency=12,start=c(2560))
plot(data_ts)
de<-decompose(data_ts)
plot(de)
adf_test<-adf.test(data_ts)
adf_test
acf(data_ts)
pacf(data_ts)
data_ts_diff<-diff(data_ts)
plot(data_ts_diff)
adf_test_2<-adf.test(data_ts_diff)
adf_test_2
acf(data_ts_diff)
pacf(data_ts_diff)
auto.arima(data_ts,trace=TRUE)
model<-arima(data_ts,orde=c(0,1,2),seasonal=list(order=c(0,0,2),period=12))
coeftest(model)
Box.test(model$resid,lag=4,type="Ljung-Box")
acf_model<-acf(model$residuals,main="Correlogram")
print(summary(model))
fo<-forecast(model,h=12)
plot(fo)
ACC_ARIMA=accuracy(fo)
#ANN#
set.seed(999999)
modelANN1=mlp(data_ts,hd=1)
modelANN2=mlp(data_ts,hd=2)
modelANN3=mlp(data_ts,hd=3)
modelANN4=mlp(data_ts,hd=4)
modelANN5=mlp(data_ts,hd=5)
modelANN6=mlp(data_ts,hd=6)
modelANN7=mlp(data_ts,hd=7)
modelANN8=mlp(data_ts,hd=8)
modelANN9=mlp(data_ts,hd=9)
modelANN10=mlp(data_ts,hd=10)

#SARIMA-ANN#
set.seed(999999)
A<-fitted(model)
B<-residuals(model)
modelres_ANN1=mlp(model$residuals,hd=1)
modelres_ANN2=mlp(model$residuals,hd=2)
modelres_ANN3=mlp(model$residuals,hd=3)
modelres_ANN4=mlp(model$residuals,hd=4)
modelres_ANN5=mlp(model$residuals,hd=5)
modelres_ANN6=mlp(model$residuals,hd=6)
modelres_ANN7=mlp(model$residuals,hd=7)
modelres_ANN8=mlp(model$residuals,hd=8)
modelres_ANN9=mlp(model$residuals,hd=9)
modelres_ANN10=mlp(model$residuals,hd=10)
model_ARIMA_ANN=fitted(model)+modelres_ANN9$fitted
fo_ARIMA_ANN=forecast(model_ARIMA_ANN,h=12)
plot(fo_ARIMA_ANN)
ACC_ARIMA_ANN=accuracy(fo_ARIMA_ANN)
#SARIMA-ANN-REG#
fit.ARIMA=fitted(model)
fit.ANN=modelANN10$fitted
datamix<-cbind(data_ts,fit.ARIMA,fit.ANN)
reg<-lm(data_ts~0+fit.ARIMA+fit.ANN,data=datamix)
reg
A1=forecast(model)
A2=forecast(modelANN10)
newtest=cbind(data_ts,fit.ARIMA=A1$mean,fit.ANN=A2$mean)
forannarimareg<-predict(reg,newtest,h=12)
ANN_ARIMA_ANN_REG=accuracy(reg)